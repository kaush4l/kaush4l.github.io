(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{8057:(e,r,t)=>{"use strict";t.d(r,{default:()=>T});var s=t(5155),a=t(2115),n=t(4071),o=t(8022),l=t(3777),i=t(3207),d=t(7461),c=t(6076),u=t(7721),x=t(174),h=t(7950),g=t(5987),p=t(8124),m=t(9466),f=t(9621),y=t(322),b=t(2163),j=t(4249),A=t(192),w=t(888),v=t(1650),C=t(7131),k=t(8759),S=t(3736),R=t(2744),M=t(7576),P=t(6971),W=t(372),z=t(4466),I=t(8781),L=t(7308);let D=null;function T({initialSystemPrompt:e}){let[r,T]=(0,a.useState)([]),[E,B]=(0,a.useState)(""),[_,F]=(0,a.useState)(null),[N,U]=(0,a.useState)(!1),[$,O]=(0,a.useState)(e),[G,H]=(0,a.useState)({loaded:!1,loading:!1,progress:0}),[V,q]=(0,a.useState)(!1),[K,J]=(0,a.useState)(!1),[Q,X]=(0,a.useState)(""),Y=(0,a.useRef)(""),Z=(0,a.useRef)(0),[ee,er]=(0,a.useState)({loaded:!1,loading:!1,progress:0}),[et,es]=(0,a.useState)(""),[ea,en]=(0,a.useState)(""),[eo,el]=(0,a.useState)(null),[ei,ed]=(0,a.useState)({loaded:!1,loading:!1,progress:0}),[ec,eu]=(0,a.useState)({speed:1,autoPlay:!0}),ex=(0,a.useRef)(null),eh=(0,a.useRef)(null),eg=(0,a.useRef)(null),ep=(0,a.useRef)(null),em=(0,a.useRef)(null),ef=(0,a.useRef)(null),ey=(0,a.useRef)(null),eb=(0,a.useRef)([]),ej=(0,a.useRef)(null),eA=(0,a.useRef)(!1),ew=(0,a.useRef)(null);(0,a.useEffect)(()=>((0,I.P)().then(e=>{F(e),es(e.recommended.llm)}),D=new(window.AudioContext||window.webkitAudioContext),eh.current=new L.O(async e=>new Promise((r,t)=>{if(!ex.current)return r();ex.current?.postMessage({type:"synthesize",data:{text:e,generation_config:{speed:ec.speed}}}),r()})),eg.current=new L.S(e=>{ec.autoPlay&&ex.current&&ei.loaded&&ex.current.postMessage({type:"synthesize",data:{text:e,generation_config:{speed:ec.speed}}})}),()=>{em.current?.terminate(),ef.current?.terminate(),ex.current?.terminate(),ey.current?.state!=="inactive"&&ey.current?.stop(),ej.current?.getTracks().forEach(e=>e.stop())}),[]),(0,a.useEffect)(()=>{ep.current?.scrollIntoView({behavior:"smooth"})},[r,Q,ea]),(0,a.useEffect)(()=>{},[ee,G,ei]);let ev=async e=>{D||(D=new(window.AudioContext||window.webkitAudioContext));let r=await e.arrayBuffer();try{let e=await D.decodeAudioData(r),t=e.getChannelData(0);if(16e3!==e.sampleRate){let r=e.sampleRate/16e3,s=Math.round(t.length/r),a=new Float32Array(s);for(let e=0;e<s;e++){let s=Math.round(e*r);a[e]=t[Math.min(s,t.length-1)]}return a}return t}catch(e){return new Float32Array(0)}},eC=(0,a.useCallback)(async()=>{H({loaded:!1,loading:!0,progress:0});try{let e=new Worker(t.tu(new URL(t.p+t.u(552),t.b)),{type:void 0});em.current=e,e.onmessage=e=>{let{type:r,data:t}=e.data;if("progress"===r)H(e=>({...e,progress:Math.round((t.progress??0)*100)}));else if("ready"===r)H({loaded:!0,loading:!1,progress:100});else if("error"===r)H({loaded:!1,loading:!1,progress:0,error:t}),J(!1),eA.current=!1;else if("transcription"===r){let e=t.trim();e&&(X(e),Y.current=e,Z.current=Date.now()),J(!1),eA.current=!1}},e.postMessage({type:"load"})}catch(e){H({loaded:!1,loading:!1,progress:0,error:e.message})}},[]),ek=(0,a.useRef)([]),eS=(0,a.useRef)(!1),eR=async e=>new Promise(async r=>{D||(D=new(window.AudioContext||window.webkitAudioContext)),"suspended"===D.state&&await D.resume();let t=D.createBuffer(1,e.length,16e3);t.getChannelData(0).set(e);let s=D.createBufferSource();s.buffer=t,s.connect(D.destination),s.onended=()=>{r()},s.start()}),eM=async()=>{if(!eS.current&&0!==ek.current.length){for(eS.current=!0;ek.current.length>0;){let e=ek.current.shift();e&&await eR(e)}eS.current=!1}},eP=(0,a.useCallback)(e=>{let{type:r,data:t}=e.data;"progress"===r?ed(e=>({...e,progress:Math.round((t.progress??0)*100)})):"ready"===r?ed({loaded:!0,loading:!1,progress:100}):"error"===r?ed({loaded:!1,loading:!1,progress:0,error:t}):"complete"===r&&(ek.current.push(t),eM())},[]),eW=(0,a.useCallback)(async()=>{ed({loaded:!1,loading:!0,progress:0});try{let e=new Worker(t.tu(new URL(t.p+t.u(528),t.b)),{type:void 0});ex.current=e,e.onmessage=eP,e.postMessage({type:"load",data:{model:I.L.tts.default}})}catch(e){ed({loaded:!1,loading:!1,progress:0,error:e.message})}},[eP]),ez=(0,a.useCallback)(e=>{ex.current&&ei.loaded&&e.trim()&&ex.current.postMessage({type:"synthesize",data:{text:e,generation_config:{speed:ec.speed}}})},[ei.loaded,ec]),eI=(0,a.useCallback)(async()=>{if(et){er({loaded:!1,loading:!0,progress:0});try{ef.current?.terminate();let e=new Worker(t.tu(new URL(t.p+t.u(486),t.b)),{type:void 0});ef.current=e,e.onmessage=e=>{let{type:r,data:t}=e.data;if("progress"===r)if("stream"===t.status){let e=t.output;en(r=>r+e),ec.autoPlay&&ei.loaded&&eg.current?.add(e)}else er(e=>({...e,progress:Math.round((t.progress??0)*100)}));else"ready"===r?er({loaded:!0,loading:!1,progress:100}):"complete"===r?(T(e=>[...e,{role:"assistant",content:t}]),ec.autoPlay&&ei.loaded&&eg.current?.flush(),en(""),U(!1)):"error"===r&&(er({loaded:!1,loading:!1,progress:0,error:t}),U(!1))},e.postMessage({type:"load",data:{model:et}})}catch(e){er({loaded:!1,loading:!1,progress:0,error:e.message})}}},[et,ec.autoPlay,ei.loaded]),eL=(0,a.useCallback)(async()=>{if(!G.loaded)return alert("Please load the STT model first");try{let e=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:16e3}});ej.current=e;let r=new MediaRecorder(e,{mimeType:"audio/webm"});eb.current=[],ey.current=r,X(""),Y.current="",Z.current=Date.now(),q(!0),r.ondataavailable=async e=>{if(e.data.size>0&&(eb.current.push(e.data),!eA.current&&em.current)){eA.current=!0;let e=new Blob(eb.current,{type:"audio/webm"}),r=await ev(e);r.length>0?(J(!0),em.current.postMessage({type:"transcribe",data:{audio:r}})):eA.current=!1}},r.onstop=()=>{e.getTracks().forEach(e=>e.stop()),q(!1);let r=Y.current;r&&B(e=>{let t=e.trim();return t?`${t} ${r}`:r}),X(""),Y.current=""},r.start(1e3)}catch(e){alert("Could not access microphone: "+e.message)}},[G.loaded]),eD=(0,a.useCallback)(()=>ey.current?.stop(),[]);(0,a.useEffect)(()=>{let e;return V&&(Z.current=Date.now(),e=setInterval(()=>{Date.now()-Z.current>2e3&&eD()},500)),()=>clearInterval(e)},[V,eD]);let eT=async()=>{if(!E.trim()&&!Q&&!eo||N)return;let e=E.trim()+(Q?(E?" ":"")+Q:""),t={role:"user",content:eo?`![image](${eo})
${e}`:e},s=[{role:"system",content:$},...r,t];T(e=>[...e,t]),B(""),X(""),U(!0),en(""),ef.current&&ee.loaded?(ef.current.postMessage({type:"generate",data:{messages:s,images:eo?[eo]:[]}}),el(null)):setTimeout(()=>{T(r=>[...r,{role:"assistant",content:"LLM not loaded. I received: \n"+e}]),U(!1)},500)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(n.default,{sx:{maxWidth:1200,mx:"auto",display:"flex",gap:3,flexDirection:{xs:"column",md:"row"}},children:[(0,s.jsxs)(n.default,{sx:{width:{xs:"100%",md:360},flexShrink:0},children:[(0,s.jsx)(o.A,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"AI Models"}),_&&(0,s.jsxs)(l.A,{severity:"info",sx:{mb:2},children:["System: ",_.tier," | ",_.details.webgpu?"WebGPU":"WASM"]}),(0,s.jsx)(i.A,{sx:{mb:2},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(o.A,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Speech-to-Text"}),G.loaded?(0,s.jsx)(c.A,{icon:(0,s.jsx)(M.A,{}),label:"Ready",color:"success"}):(0,s.jsx)(u.A,{variant:"outlined",startIcon:(0,s.jsx)(R.A,{}),onClick:eC,disabled:G.loading,fullWidth:!0,size:"small",children:G.loading?`Loading ${G.progress}%`:"Load STT"}),G.loading&&(0,s.jsx)(x.A,{variant:"determinate",value:G.progress,sx:{mt:1}})]})}),(0,s.jsx)(i.A,{sx:{mb:2},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(o.A,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Language Model"}),(0,s.jsx)(o.A,{variant:"caption",display:"block",color:"text.secondary",sx:{mb:1},children:et?et.split("/").pop():"Detecting..."}),ee.loaded?(0,s.jsx)(c.A,{icon:(0,s.jsx)(M.A,{}),label:"Ready",color:"success"}):(0,s.jsx)(u.A,{variant:"contained",startIcon:(0,s.jsx)(R.A,{}),onClick:eI,disabled:ee.loading||!et,fullWidth:!0,children:ee.loading?`Loading ${ee.progress}%`:"Load LLM"}),ee.loading&&(0,s.jsx)(x.A,{variant:"determinate",value:ee.progress,sx:{mt:1}}),ee.error&&(0,s.jsx)(l.A,{severity:"error",sx:{mt:1,fontSize:"0.75rem"},children:ee.error})]})}),(0,s.jsx)(i.A,{children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(o.A,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"System Prompt"}),(0,s.jsx)(h.A,{multiline:!0,rows:4,fullWidth:!0,placeholder:"Control AI behavior...",value:$,onChange:e=>O(e.target.value),size:"small",sx:{"& .MuiInputBase-root":{fontSize:"0.875rem"}}})]})}),(0,s.jsx)(i.A,{sx:{mt:2},children:(0,s.jsxs)(d.A,{children:[(0,s.jsx)(o.A,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Text-to-Speech"}),(0,s.jsxs)(g.A,{spacing:2,children:[(0,s.jsxs)(p.A,{fullWidth:!0,size:"small",children:[(0,s.jsx)(m.A,{children:"Speed"}),(0,s.jsxs)(f.A,{value:ec.speed,label:"Speed",onChange:e=>eu(r=>({...r,speed:Number(e.target.value)})),disabled:!ei.loaded,children:[(0,s.jsx)(y.A,{value:.8,children:"Slow (0.8x)"}),(0,s.jsx)(y.A,{value:1,children:"Normal (1.0x)"}),(0,s.jsx)(y.A,{value:1.2,children:"Fast (1.2x)"})]})]}),(0,s.jsx)(u.A,{size:"small",variant:ec.autoPlay?"contained":"outlined",onClick:()=>eu(e=>({...e,autoPlay:!e.autoPlay})),color:ec.autoPlay?"primary":"inherit",children:ec.autoPlay?"Stream: ON":"Stream: OFF"})]}),(0,s.jsx)(n.default,{sx:{mt:2},children:ei.loaded?(0,s.jsx)(c.A,{icon:(0,s.jsx)(M.A,{}),label:"Ready",color:"success"}):(0,s.jsx)(u.A,{variant:"outlined",startIcon:(0,s.jsx)(k.A,{}),onClick:eW,disabled:ei.loading,fullWidth:!0,size:"small",children:ei.loading?`Loading ${ei.progress}%`:"Load TTS"})}),ei.loading&&(0,s.jsx)(x.A,{variant:"determinate",value:ei.progress,sx:{mt:1}})]})})]}),(0,s.jsxs)(n.default,{sx:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:600},children:[(0,s.jsxs)(g.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:1},children:[(0,s.jsx)(o.A,{variant:"h6",fontWeight:600,children:"Ask Me Anything"}),(0,s.jsx)(u.A,{size:"small",startIcon:(0,s.jsx)(P.A,{}),onClick:()=>T([]),color:"inherit",children:"Clear Chat"})]}),(0,s.jsxs)(b.A,{sx:{flexGrow:1,p:2,mb:2,overflow:"auto",maxHeight:500,backgroundColor:"background.default",border:"1px solid",borderColor:"divider"},children:[0===r.length&&!ea&&(0,s.jsx)(n.default,{sx:{textAlign:"center",py:8,color:"text.secondary"},children:(0,s.jsx)(o.A,{variant:"body2",children:"Context loaded from Resume. Start asking questions!"})}),r.map((e,r)=>(0,s.jsx)(n.default,{sx:{mb:2,display:"flex",justifyContent:"user"===e.role?"flex-end":"flex-start"},children:(0,s.jsxs)(b.A,{sx:{p:2,maxWidth:"85%",backgroundColor:"user"===e.role?"primary.main":"white",color:"user"===e.role?"white":"text.primary",borderRadius:2},children:[(0,s.jsx)(o.A,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:e.content}),"assistant"===e.role&&ei.loaded&&(0,s.jsx)(j.A,{size:"small",onClick:()=>ez(e.content),sx:{mt:1,float:"right"},children:(0,s.jsx)(k.A,{fontSize:"small"})})]})},r)),(ea||N)&&(0,s.jsx)(n.default,{sx:{mb:2,display:"flex",justifyContent:"flex-start"},children:(0,s.jsx)(b.A,{sx:{p:2,maxWidth:"85%",backgroundColor:"white",border:"1px dashed",borderColor:"primary.main",borderRadius:2},children:(0,s.jsxs)(o.A,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:[ea,!ea&&(0,s.jsx)(A.A,{size:12,sx:{ml:1}})]})})}),V&&Q&&(0,s.jsx)(n.default,{sx:{mb:2,display:"flex",justifyContent:"flex-end"},children:(0,s.jsx)(b.A,{sx:{p:2,maxWidth:"80%",backgroundColor:"rgba(124, 58, 237, 0.1)",fontStyle:"italic",borderRadius:2},children:(0,s.jsxs)(o.A,{variant:"body2",children:[Q,"..."]})})}),(0,s.jsx)("div",{ref:ep})]}),(0,s.jsxs)(g.A,{spacing:2,children:[eo&&(0,s.jsxs)(n.default,{sx:{position:"relative",width:80,height:80,mb:1,borderRadius:1,overflow:"hidden",border:"1px solid",borderColor:"divider"},children:[(0,s.jsx)("img",{src:eo,alt:"Selected",style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,s.jsx)(j.A,{size:"small",onClick:()=>el(null),sx:{position:"absolute",top:0,right:0,bgcolor:"rgba(0,0,0,0.5)",color:"white","&:hover":{bgcolor:"rgba(0,0,0,0.7)"}},children:(0,s.jsx)(W.A,{fontSize:"small"})})]}),(0,s.jsxs)(g.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",capture:"environment",ref:ew,style:{display:"none"},onChange:e=>{let r=e.target.files?.[0];if(r){let e=new FileReader;e.onload=e=>el(e.target?.result),e.readAsDataURL(r)}}}),(0,s.jsx)(w.A,{title:"Upload or Capture Image",children:(0,s.jsx)(j.A,{component:"span",color:"primary",onClick:()=>{ew.current?.click()},children:(0,s.jsx)(z.A,{})})}),(0,s.jsx)(h.A,{fullWidth:!0,placeholder:V?"Listening...":"Type a message...",value:V?Q:E,onChange:e=>{V?(X(e.target.value),Y.current=e.target.value):B(e.target.value)},onKeyPress:e=>"Enter"===e.key&&eT(),disabled:N,size:"small",autoComplete:"off"}),(0,s.jsx)(j.A,{color:V?"error":"primary",onClick:V?eD:eL,disabled:!G.loaded,sx:{backgroundColor:V?"error.main":"primary.main",color:"white","&:hover":{backgroundColor:V?"error.dark":"primary.dark"},animation:V?"pulse 1.5s infinite":"none","@keyframes pulse":{"0%":{boxShadow:"0 0 0 0px rgba(239, 68, 68, 0.4)"},"100%":{boxShadow:"0 0 0 10px rgba(239, 68, 68, 0)"}}},children:V?(0,s.jsx)(S.A,{}):(0,s.jsx)(C.A,{})}),(0,s.jsx)(u.A,{variant:"contained",onClick:eT,disabled:N||!E.trim()&&!Q&&!eo,endIcon:N?(0,s.jsx)(A.A,{size:20,color:"inherit"}):(0,s.jsx)(v.A,{}),children:"Send"})]}),V&&(0,s.jsxs)(l.A,{severity:"error",variant:"filled",sx:{py:0},children:[(0,s.jsxs)(g.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,s.jsx)(n.default,{sx:{width:8,height:8,bgcolor:"white",borderRadius:"50%",animation:"blink 1s infinite"}}),(0,s.jsx)(o.A,{variant:"caption",fontWeight:700,children:"RECORDING LIVE"})]}),(0,s.jsx)("style",{children:"@keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }"})]})]})]})]})})}},9322:(e,r,t)=>{Promise.resolve().then(t.bind(t,8057)),Promise.resolve().then(t.bind(t,6430)),Promise.resolve().then(t.bind(t,804)),Promise.resolve().then(t.bind(t,7911)),Promise.resolve().then(t.bind(t,2849))}},e=>{e.O(0,[361,516,93,911,441,794,358],()=>e(e.s=9322)),_N_E=e.O()}]);